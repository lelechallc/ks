{
  "_CONFIG_VERSION": "935003c6f0f2ced3a87a85329059b6ec_local",
  "_DRAGONFLY_CREATE_TIME": "2024-05-13 17:43:00",
  "_DRAGONFLY_VERSION": "0.8.0",
  "kess_config": {},
  "pipeline_manager_config": {
    "base_pipeline": {
      "processor": {
        "convert_csv_to_tf_sequence_example_72D056": {
          "$metadata": {
            "$input_common_attrs": [
              "csv_sample_data"
            ],
            "$input_item_attrs": [],
            "$modify_item_tables": [],
            "$output_common_attrs": [
              "tf_sequence_example"
            ],
            "$output_item_attrs": []
          },
          "column_separator": "|",
          "common_attrs": [
            {
              "column_index": 16,
              "column_name": "age_segment",
              "type": "int"
            },
            {
              "column_index": 17,
              "column_name": "gender",
              "type": "int"
            },
            {
              "column_index": 18,
              "column_name": "device_id",
              "type": "string"
            },
            {
              "column_index": 19,
              "column_name": "photo_id",
              "type": "int"
            },
            {
              "column_index": 20,
              "column_name": "photo_author_id",
              "type": "int"
            },
            {
              "column_index": 28,
              "column_name": "user_id",
              "type": "int"
            }
          ],
          "from_extra_var": "csv_sample_data",
          "item_attrs": [
            {
              "column_index": 0,
              "column_name": "comment_id",
              "type": "int"
            },
            {
              "column_index": 1,
              "column_name": "author_id",
              "type": "int"
            },
            {
              "column_index": 2,
              "column_name": "like_cnt",
              "type": "int"
            },
            {
              "column_index": 3,
              "column_name": "reply_cnt",
              "type": "int"
            },
            {
              "column_index": 4,
              "column_name": "dislike_cnt",
              "type": "int"
            },
            {
              "column_index": 5,
              "column_name": "realshow_cnt",
              "type": "int"
            },
            {
              "column_index": 6,
              "column_name": "minute_diff",
              "type": "float"
            },
            {
              "column_index": 7,
              "column_name": "ltr",
              "type": "float"
            },
            {
              "column_index": 8,
              "column_name": "rtr",
              "type": "float"
            },
            {
              "column_index": 9,
              "column_name": "showaction",
              "type": "int"
            },
            {
              "column_index": 10,
              "column_name": "replyaction",
              "type": "int"
            },
            {
              "column_index": 11,
              "column_name": "likeaction",
              "type": "int"
            },
            {
              "column_index": 12,
              "column_name": "expandaction",
              "type": "int"
            },
            {
              "column_index": 13,
              "column_name": "audienceaction",
              "type": "int"
            },
            {
              "column_index": 14,
              "column_name": "reportaction",
              "type": "int"
            },
            {
              "column_index": 15,
              "column_name": "comment_content_segs",
              "type": "string_list"
            },
            {
              "column_index": 21,
              "column_name": "comment_genre",
              "type": "int"
            },
            {
              "column_index": 22,
              "column_name": "risk_insult_tag",
              "type": "int"
            },
            {
              "column_index": 23,
              "column_name": "risk_negative_tag",
              "type": "int"
            },
            {
              "column_index": 24,
              "column_name": "risk_inactive_tag",
              "type": "int"
            },
            {
              "column_index": 25,
              "column_name": "mmu_category_tag",
              "type": "int"
            },
            {
              "column_index": 26,
              "column_name": "mmu_emotion_tag",
              "type": "int"
            },
            {
              "column_index": 27,
              "column_name": "mmu_entity_list",
              "type": "int_list"
            },
            {
              "column_index": 29,
              "column_name": "predict_reply_score",
              "type": "float"
            },
            {
              "column_index": 30,
              "column_name": "quality_v2_score",
              "type": "float"
            },
            {
              "column_index": 31,
              "column_name": "predict_like_score",
              "type": "float"
            },
            {
              "column_index": 32,
              "column_name": "recall_type",
              "type": "int"
            },
            {
              "column_index": 33,
              "column_name": "expandaction_first",
              "type": "int"
            },
            {
              "column_index": 34,
              "column_name": "expandaction_second",
              "type": "int"
            },
            {
              "column_index": 35,
              "column_name": "likeaction_first",
              "type": "int"
            },
            {
              "column_index": 36,
              "column_name": "likeaction_second",
              "type": "int"
            },
            {
              "column_index": 37,
              "column_name": "replyaction_first",
              "type": "int"
            },
            {
              "column_index": 38,
              "column_name": "replyaction_second",
              "type": "int"
            },
            {
              "column_index": 39,
              "column_name": "reportaction_first",
              "type": "int"
            },
            {
              "column_index": 40,
              "column_name": "reportaction_second",
              "type": "int"
            },
            {
              "column_index": 41,
              "column_name": "audienceaction_first",
              "type": "int"
            },
            {
              "column_index": 42,
              "column_name": "audienceaction_second",
              "type": "int"
            },
            {
              "column_index": 43,
              "column_name": "like_rank_index",
              "type": "int"
            },
            {
              "column_index": 44,
              "column_name": "reply_rank_index",
              "type": "int"
            },
            {
              "column_index": 45,
              "column_name": "realshow_rank_index",
              "type": "int"
            },
            {
              "column_index": 46,
              "column_name": "dislike_rank_index",
              "type": "int"
            }
          ],
          "item_separator": ",",
          "list_separator": " ",
          "save_result_to": "tf_sequence_example",
          "type_name": "OfflineCsvToTfSequenceExampleEnricher"
        },
        "count_reco_result_7BD7E7": {
          "$metadata": {
            "$input_common_attrs": [],
            "$input_item_attrs": [],
            "$modify_item_tables": [],
            "$output_common_attrs": [
              "send_sample_cnt"
            ],
            "$output_item_attrs": []
          },
          "save_result_size_to_common_attr": "send_sample_cnt",
          "type_name": "CommonRecoCountRecoResultEnricher"
        },
        "enrich_attr_by_lua_AF7E6F": {
          "$metadata": {
            "$input_common_attrs": [
              "device_id",
              "user_id"
            ],
            "$input_item_attrs": [],
            "$modify_item_tables": [],
            "$output_common_attrs": [
              "user_hash"
            ],
            "$output_item_attrs": []
          },
          "export_common_attr": [
            "user_hash"
          ],
          "function_for_common": "get_hash",
          "import_common_attr": [
            "user_id",
            "device_id"
          ],
          "lua_script": "function get_hash()\n          if device_id == nil or device_id == \"\" then\n            return tonumber(user_id or '0')\n          end\n          return util.CityHash64(device_id)\n        end",
          "type_name": "CommonRecoLuaAttrEnricher"
        },
        "enrich_attr_by_lua_F7EA79": {
          "$metadata": {
            "$input_common_attrs": [],
            "$input_item_attrs": [
              "expandaction_first",
              "likeaction_first",
              "replyaction_first"
            ],
            "$modify_item_tables": [],
            "$output_common_attrs": [],
            "$output_item_attrs": [
              "expandAction_v",
              "likeAction_v",
              "replyAction_v"
            ]
          },
          "export_item_attr": [
            "expandAction_v",
            "likeAction_v",
            "replyAction_v"
          ],
          "function_for_item": "trans",
          "import_item_attr": [
            "expandaction_first",
            "likeaction_first",
            "replyaction_first"
          ],
          "lua_script": "function trans() \n            return expandaction_first * 1.0, likeaction_first * 1.0, replyaction_first * 1.0\n          end",
          "type_name": "CommonRecoLuaAttrEnricher"
        },
        "extract_kuiba_parameter_67B29A": {
          "$metadata": {
            "$input_common_attrs": [
              "age_segment",
              "device_id",
              "gender",
              "photo_author_id",
              "photo_id",
              "user_id"
            ],
            "$input_item_attrs": [],
            "$modify_item_tables": [],
            "$output_common_attrs": [
              "comment_common_signs",
              "comment_common_slots"
            ],
            "$output_item_attrs": []
          },
          "config": {
            "age_segment": {
              "attrs": [
                {
                  "attr": [
                    "age_segment"
                  ],
                  "converter": "id",
                  "key_type": 102,
                  "mio_slot_key_type": 102
                }
              ]
            },
            "device_id": {
              "attrs": [
                {
                  "attr": [
                    "device_id"
                  ],
                  "converter": "id",
                  "key_type": 106,
                  "mio_slot_key_type": 106
                }
              ]
            },
            "gender": {
              "attrs": [
                {
                  "attr": [
                    "gender"
                  ],
                  "converter": "id",
                  "key_type": 101,
                  "mio_slot_key_type": 101
                }
              ]
            },
            "photo_author_id": {
              "attrs": [
                {
                  "attr": [
                    "photo_author_id"
                  ],
                  "converter": "id",
                  "key_type": 202,
                  "mio_slot_key_type": 104
                }
              ]
            },
            "photo_id": {
              "attrs": [
                {
                  "attr": [
                    "photo_id"
                  ],
                  "converter": "id",
                  "key_type": 103,
                  "mio_slot_key_type": 103
                }
              ]
            },
            "user_id": {
              "attrs": [
                {
                  "attr": [
                    "user_id"
                  ],
                  "converter": "id",
                  "key_type": 202,
                  "mio_slot_key_type": 105
                }
              ]
            }
          },
          "is_common_attr": true,
          "parameters_output": "comment_common_signs",
          "slots_output": "comment_common_slots",
          "type_name": "KuibaParameterAttrEnricher"
        },
        "extract_kuiba_parameter_D4D652": {
          "$metadata": {
            "$input_common_attrs": [
              "author_id",
              "comment_content_segs",
              "comment_genre",
              "comment_id",
              "dislike_cnt",
              "dislike_rank_index",
              "like_cnt",
              "like_rank_index",
              "ltr",
              "ltr_copy",
              "minute_diff",
              "mmu_category_tag",
              "mmu_emotion_tag",
              "mmu_entity_list",
              "realshow_rank_index",
              "reply_cnt",
              "reply_rank_index",
              "risk_inactive_tag",
              "risk_insult_tag",
              "risk_negative_tag",
              "rtr",
              "rtr_copy",
              "showAction"
            ],
            "$input_item_attrs": [
              "author_id",
              "comment_content_segs",
              "comment_genre",
              "comment_id",
              "dislike_cnt",
              "dislike_rank_index",
              "like_cnt",
              "like_rank_index",
              "ltr",
              "ltr_copy",
              "minute_diff",
              "mmu_category_tag",
              "mmu_emotion_tag",
              "mmu_entity_list",
              "realshow_rank_index",
              "reply_cnt",
              "reply_rank_index",
              "risk_inactive_tag",
              "risk_insult_tag",
              "risk_negative_tag",
              "rtr",
              "rtr_copy",
              "showAction"
            ],
            "$modify_item_tables": [],
            "$output_common_attrs": [],
            "$output_item_attrs": [
              "comment_item_signs",
              "comment_item_slots"
            ]
          },
          "config": {
            "author_id": {
              "attrs": [
                {
                  "attr": [
                    "author_id"
                  ],
                  "converter": "id",
                  "key_type": 202,
                  "mio_slot_key_type": 202
                }
              ]
            },
            "comment_content_segs": {
              "attrs": [
                {
                  "attr": [
                    "comment_content_segs"
                  ],
                  "converter": "list",
                  "converter_args": {
                    "enable_filter": false,
                    "limit": 16,
                    "reversed": false
                  },
                  "key_type": 212,
                  "mio_slot_key_type": 212,
                  "type": 5
                }
              ]
            },
            "comment_genre": {
              "attrs": [
                {
                  "attr": [
                    "comment_genre"
                  ],
                  "converter": "id",
                  "key_type": 213,
                  "mio_slot_key_type": 213
                }
              ]
            },
            "comment_id": {
              "attrs": [
                {
                  "attr": [
                    "comment_id"
                  ],
                  "converter": "id",
                  "key_type": 201,
                  "mio_slot_key_type": 201
                }
              ]
            },
            "dislike_cnt": {
              "attrs": [
                {
                  "attr": [
                    "dislike_cnt"
                  ],
                  "converter": "discrete",
                  "converter_args": "3,0,100000,1,0",
                  "key_type": 209,
                  "mio_slot_key_type": 209
                }
              ]
            },
            "dislike_rank_index": {
              "attrs": [
                {
                  "attr": [
                    "dislike_rank_index"
                  ],
                  "converter": "id",
                  "key_type": 223,
                  "mio_slot_key_type": 223
                }
              ]
            },
            "like_cnt": {
              "attrs": [
                {
                  "attr": [
                    "like_cnt"
                  ],
                  "converter": "discrete",
                  "converter_args": "5,0,100000,1,0",
                  "key_type": 203,
                  "mio_slot_key_type": 203
                }
              ]
            },
            "like_rank_index": {
              "attrs": [
                {
                  "attr": [
                    "like_rank_index"
                  ],
                  "converter": "id",
                  "key_type": 220,
                  "mio_slot_key_type": 220
                }
              ]
            },
            "ltr": {
              "attrs": [
                {
                  "attr": [
                    "ltr"
                  ],
                  "converter": "discrete",
                  "converter_args": "0.001,0,1000,1,0",
                  "key_type": 206,
                  "mio_slot_key_type": 206
                }
              ]
            },
            "ltr_copy": {
              "attrs": [
                {
                  "attr": [
                    "ltr_copy"
                  ],
                  "converter": "discrete",
                  "converter_args": "0.001,0,1000,137,0",
                  "key_type": 210,
                  "mio_slot_key_type": 210
                }
              ]
            },
            "minute_diff": {
              "attrs": [
                {
                  "attr": [
                    "minute_diff"
                  ],
                  "converter": "discrete",
                  "converter_args": "36,0,336,1,0",
                  "key_type": 205,
                  "mio_slot_key_type": 205
                }
              ]
            },
            "mmu_category_tag": {
              "attrs": [
                {
                  "attr": [
                    "mmu_category_tag"
                  ],
                  "converter": "id",
                  "key_type": 217,
                  "mio_slot_key_type": 217
                }
              ]
            },
            "mmu_emotion_tag": {
              "attrs": [
                {
                  "attr": [
                    "mmu_emotion_tag"
                  ],
                  "converter": "id",
                  "key_type": 218,
                  "mio_slot_key_type": 218
                }
              ]
            },
            "mmu_entity_list": {
              "attrs": [
                {
                  "attr": [
                    "mmu_entity_list"
                  ],
                  "converter": "list",
                  "converter_args": {
                    "enable_filter": false,
                    "limit": 10,
                    "reversed": false
                  },
                  "key_type": 219,
                  "mio_slot_key_type": 219,
                  "type": 5
                }
              ]
            },
            "realshow_rank_index": {
              "attrs": [
                {
                  "attr": [
                    "realshow_rank_index"
                  ],
                  "converter": "id",
                  "key_type": 222,
                  "mio_slot_key_type": 222
                }
              ]
            },
            "reply_cnt": {
              "attrs": [
                {
                  "attr": [
                    "reply_cnt"
                  ],
                  "converter": "discrete",
                  "converter_args": "5,0,100000,1,0",
                  "key_type": 204,
                  "mio_slot_key_type": 204
                }
              ]
            },
            "reply_rank_index": {
              "attrs": [
                {
                  "attr": [
                    "reply_rank_index"
                  ],
                  "converter": "id",
                  "key_type": 221,
                  "mio_slot_key_type": 221
                }
              ]
            },
            "risk_inactive_tag": {
              "attrs": [
                {
                  "attr": [
                    "risk_inactive_tag"
                  ],
                  "converter": "id",
                  "key_type": 216,
                  "mio_slot_key_type": 216
                }
              ]
            },
            "risk_insult_tag": {
              "attrs": [
                {
                  "attr": [
                    "risk_insult_tag"
                  ],
                  "converter": "id",
                  "key_type": 214,
                  "mio_slot_key_type": 214
                }
              ]
            },
            "risk_negative_tag": {
              "attrs": [
                {
                  "attr": [
                    "risk_negative_tag"
                  ],
                  "converter": "id",
                  "key_type": 215,
                  "mio_slot_key_type": 215
                }
              ]
            },
            "rtr": {
              "attrs": [
                {
                  "attr": [
                    "rtr"
                  ],
                  "converter": "discrete",
                  "converter_args": "0.001,0,1000,1,0",
                  "key_type": 207,
                  "mio_slot_key_type": 207
                }
              ]
            },
            "rtr_copy": {
              "attrs": [
                {
                  "attr": [
                    "rtr_copy"
                  ],
                  "converter": "discrete",
                  "converter_args": "0.001,0,1000,137,0",
                  "key_type": 211,
                  "mio_slot_key_type": 211
                }
              ]
            },
            "showAction": {
              "attrs": [
                {
                  "attr": [
                    "showAction"
                  ],
                  "converter": "id",
                  "key_type": 208,
                  "mio_slot_key_type": 208
                }
              ]
            }
          },
          "is_common_attr": false,
          "parameters_output": "comment_item_signs",
          "slots_output": "comment_item_slots",
          "type_name": "KuibaParameterAttrEnricher"
        },
        "fetch_message_818D68": {
          "$metadata": {
            "$input_common_attrs": [],
            "$input_item_attrs": [],
            "$modify_item_tables": [],
            "$output_common_attrs": [
              "csv_sample_data"
            ],
            "$output_item_attrs": []
          },
          "group_id": "reco_forward_open_log",
          "hdfs_format": "raw_text",
          "hdfs_path": "viewfs:///home/reco_algorithm/dw/reco_algorithm.db/comment_model_data_zt08_dev1/datatype=0509_18_19_2hTrain_rank",
          "output_attr": "csv_sample_data",
          "type_name": "OfflineMessageFetchEnricher"
        },
        "log_debug_info_0579D6": {
          "$metadata": {
            "$input_common_attrs": [
              "csv_sample_data"
            ],
            "$input_item_attrs": [],
            "$modify_item_tables": [],
            "$output_common_attrs": [],
            "$output_item_attrs": []
          },
          "common_attrs": [
            "csv_sample_data"
          ],
          "for_debug_request_only": false,
          "respect_sample_logging": true,
          "type_name": "CommonRecoDebugInfoObserver"
        },
        "perflog_attr_value_464C20": {
          "$metadata": {
            "$input_common_attrs": [
              "age_segment",
              "gender"
            ],
            "$input_item_attrs": [
              "audienceAction",
              "comment_genre",
              "dislike_cnt",
              "dislike_rank_index",
              "expandAction",
              "likeAction",
              "like_cnt",
              "like_rank_index",
              "minute_diff",
              "mmu_category_tag",
              "mmu_emotion_tag",
              "realshow_cnt",
              "realshow_rank_index",
              "replyAction",
              "reply_cnt",
              "reply_rank_index",
              "reportAction",
              "risk_inactive_tag",
              "risk_insult_tag",
              "risk_negative_tag",
              "showAction"
            ],
            "$modify_item_tables": [],
            "$output_common_attrs": [],
            "$output_item_attrs": []
          },
          "check_point": "comment.test",
          "common_attrs": [
            "gender",
            "age_segment"
          ],
          "item_attrs": [
            "like_cnt",
            "reply_cnt",
            "minute_diff",
            "realshow_cnt",
            "dislike_cnt",
            "showAction",
            "expandAction",
            "replyAction",
            "likeAction",
            "audienceAction",
            "reportAction",
            "comment_genre",
            "risk_insult_tag",
            "risk_negative_tag",
            "risk_inactive_tag",
            "mmu_category_tag",
            "mmu_emotion_tag",
            "like_rank_index",
            "reply_rank_index",
            "realshow_rank_index",
            "dislike_rank_index"
          ],
          "type_name": "CommonRecoAttrValuePerflogObserver"
        },
        "perflog_attr_value_9D7430": {
          "$metadata": {
            "$input_common_attrs": [
              "send_sample_cnt"
            ],
            "$input_item_attrs": [
              "expandAction_v",
              "likeAction_v",
              "replyAction_v"
            ],
            "$modify_item_tables": [],
            "$output_common_attrs": [],
            "$output_item_attrs": []
          },
          "check_point": "comment.mio.record",
          "common_attrs": [
            "send_sample_cnt"
          ],
          "item_attrs": [
            "expandAction_v",
            "likeAction_v",
            "replyAction_v"
          ],
          "type_name": "CommonRecoAttrValuePerflogObserver"
        },
        "retrieve_from_tf_sequence_example_22B8B0": {
          "$metadata": {
            "$input_common_attrs": [
              "tf_sequence_example"
            ],
            "$input_item_attrs": [],
            "$modify_item_tables": [],
            "$output_common_attrs": [],
            "$output_item_attrs": []
          },
          "from_extra_var": "tf_sequence_example",
          "item_key_attr": "comment_id",
          "reason": 111,
          "type_name": "OfflineTensorflowSequenceExampleRetriever"
        },
        "send_to_mio_learner_EF1D78": {
          "$metadata": {
            "$input_common_attrs": [
              "comment_common_signs",
              "comment_common_slots",
              "comment_item_signs",
              "comment_item_slots",
              "expandAction_v",
              "likeAction_v",
              "replyAction_v",
              "time_ms",
              "user_hash",
              "user_id"
            ],
            "$input_item_attrs": [
              "comment_common_signs",
              "comment_common_slots",
              "comment_item_signs",
              "comment_item_slots",
              "expandAction_v",
              "likeAction_v",
              "replyAction_v"
            ],
            "$modify_item_tables": [],
            "$output_common_attrs": [],
            "$output_item_attrs": []
          },
          "attrs": [
            "expandAction_v",
            "likeAction_v",
            "replyAction_v"
          ],
          "label_attr": "likeAction_v",
          "lineid_attr": "user_id",
          "signs_attrs": [
            "comment_common_signs",
            "comment_item_signs"
          ],
          "slots_attrs": [
            "comment_common_slots",
            "comment_item_slots"
          ],
          "time_ms_attr": "time_ms",
          "type_name": "MioRecordChannelObserver",
          "user_hash_attr": "user_hash"
        }
      },
      "type_name": "CommonRecoPipeline"
    },
    "pipeline_map": {
      "extract_fea": {
        "__PARENT": "base_pipeline",
        "pipeline": [
          "extract_kuiba_parameter_67B29A",
          "extract_kuiba_parameter_D4D652"
        ]
      },
      "read_data": {
        "__PARENT": "base_pipeline",
        "pipeline": [
          "fetch_message_818D68",
          "log_debug_info_0579D6",
          "convert_csv_to_tf_sequence_example_72D056",
          "retrieve_from_tf_sequence_example_22B8B0",
          "perflog_attr_value_464C20"
        ]
      },
      "send_mio": {
        "__PARENT": "base_pipeline",
        "pipeline": [
          "count_reco_result_7BD7E7",
          "enrich_attr_by_lua_F7EA79",
          "perflog_attr_value_9D7430",
          "enrich_attr_by_lua_AF7E6F",
          "send_to_mio_learner_EF1D78"
        ]
      }
    }
  },
  "runner_pipeline_group": {
    "default_name": {
      "core_num_thread_ratio": 0.0,
      "pipeline": [
        "read_data",
        "extract_fea",
        "send_mio"
      ],
      "thread_num": -1
    }
  },
  "service_identifier": "comment_profile"
}